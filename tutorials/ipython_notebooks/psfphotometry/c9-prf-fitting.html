

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Fitting PRFs in K2 TPFs from Campaign 9.1 &mdash; PyKE 3.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="PyKE 3.0.0 documentation" href="../../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> PyKE
          

          
            
            <img src="../../../_static/pyke-white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew31.html">What’s new in PyKE 3?</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tasks.html">PyKE tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../citing.html">Citing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Photometry tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">PyKE</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
    <li>Fitting PRFs in K2 TPFs from Campaign 9.1</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/tutorials/ipython_notebooks/psfphotometry/c9-prf-fitting.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Fitting-PRFs-in-K2-TPFs-from-Campaign-9.1">
<h1>Fitting PRFs in K2 TPFs from Campaign 9.1<a class="headerlink" href="#Fitting-PRFs-in-K2-TPFs-from-Campaign-9.1" title="Permalink to this headline">¶</a></h1>
<p>In this simple tutorial we will show how to perform PRF photometry in a
K2 target pixel file using <code class="docutils literal"><span class="pre">PyKE</span></code> and <code class="docutils literal"><span class="pre">oktopus</span></code>.</p>
<p><strong>This notebook was created with the following versions of PyKE and
oktopus:</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import pyke
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>pyke.__version__
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[2]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&#39;3.1.beta0&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import oktopus
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>oktopus.__version__
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&#39;0.1.dev12&#39;
</pre></div>
</div>
</div>
<p><strong>1. Importing the necessary packages</strong></p>
<p>As usual, let’s start off by importing a few packages from the standard
scientific Python stack:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>%matplotlib inline
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rc
rc(&#39;text&#39;, usetex=True)
font = {&#39;family&#39; : &#39;serif&#39;,
        &#39;size&#39;   : 22,
        &#39;serif&#39;  : &#39;New Century Schoolbook&#39;}
rc(&#39;font&#39;, **font)
</pre></div>
</div>
</div>
<p>Since we will perform PRF photometry in a Target Pixel File (TPF), let’s
import <code class="docutils literal"><span class="pre">KeplerTargetPixelFile</span></code> and <code class="docutils literal"><span class="pre">KeplerQualityFlags</span></code> classes from
<code class="docutils literal"><span class="pre">PyKE</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>from pyke import KeplerTargetPixelFile, KeplerQualityFlags
</pre></div>
</div>
</div>
<p>It’s always wise to take a prior look at the data, therefore, let’s
import <code class="docutils literal"><span class="pre">photutils</span></code> so that we can perform aperture photometry:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import photutils.aperture as apr
</pre></div>
</div>
</div>
<p>Additionally, we will need a model for the Pixel Response Function and
for the scene. We can import those from <code class="docutils literal"><span class="pre">PyKE</span></code>, as well.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>from pyke.prf import SimpleKeplerPRF, SceneModel, PRFPhotometry
</pre></div>
</div>
</div>
<p>Finally, we will use <code class="docutils literal"><span class="pre">oktopus</span></code> to handle our statistical assumptions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>from oktopus import UniformPrior
</pre></div>
</div>
</div>
<p><strong>2. Actual PRF Photometry</strong></p>
<p>Let’s start by instantiating a <code class="docutils literal"><span class="pre">KeplerTargetPixelFile</span></code> object (you may
either give a url or a local path to the file):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>tpf = KeplerTargetPixelFile(&#39;https://archive.stsci.edu/missions/k2/target_pixel_files/c91/&#39;
                            &#39;224300000/64000/ktwo224364733-c91_lpd-targ.fits.gz&#39;,
                            quality_bitmask=KeplerQualityFlags.CONSERVATIVE_BITMASK)
</pre></div>
</div>
</div>
<p>Note that we set
<code class="docutils literal"><span class="pre">quality_bitmask=KeplerQualityFlags.CONSERVATIVE_BITMASK</span></code>, which means
that cadences that have specific <code class="docutils literal"><span class="pre">QUALITY</span></code> flags such as
<code class="docutils literal"><span class="pre">Attitude</span> <span class="pre">tweak</span></code>, <code class="docutils literal"><span class="pre">Safe</span> <span class="pre">mode</span></code>, etc, will be ignored.</p>
<p>Let’s take a look at the pixel data using the <code class="docutils literal"><span class="pre">plot</span></code> method from
<code class="docutils literal"><span class="pre">KeplerTargetPixelFile</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>tpf.plot(frame=100)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_23_0.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_23_0.png" />
</div>
</div>
<p>Now, let’s create circular apertures around the targets using
<code class="docutils literal"><span class="pre">photutils</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>tpf.plot(frame=100)
apr.CircularAperture((941.5, 878.5), r=2).plot(color=&#39;cyan&#39;)
apr.CircularAperture((944.5, 875.5), r=2).plot(color=&#39;cyan&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_25_0.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_25_0.png" />
</div>
</div>
<p>We can also use <code class="docutils literal"><span class="pre">photutils</span></code> to create aperture photometry light curves
from the drawn apertures:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>lc1, lc2 = np.zeros(len(tpf.time)), np.zeros(len(tpf.time))
for i in range(len(tpf.time)):
    lc1[i] = apr.CircularAperture((941.5 - tpf.column, 878.5 - tpf.row), r=2).do_photometry(tpf.flux[i])[0]
    lc2[i] = apr.CircularAperture((944.5 - tpf.column, 875.5 - tpf.row), r=2).do_photometry(tpf.flux[i])[0]
</pre></div>
</div>
</div>
<p>Let’s visualize the light curves:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[17, 4])
plt.plot(tpf.time, lc1, &#39;o&#39;, markersize=2)
plt.xlabel(&quot;Time&quot;)
plt.ylabel(&quot;Flux&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[14]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x11c498898&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_29_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_29_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[17, 4])
plt.plot(tpf.time, lc2, &#39;ro&#39;, markersize=2)
plt.xlabel(&quot;Time&quot;)
plt.ylabel(&quot;Flux&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x11c6130b8&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_30_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_30_1.png" />
</div>
</div>
<p>Looking at the data before performing PRF photometry is important
because it will give us insights on how to construct our priors on the
parameters we want to estimate.</p>
<p>Another important part of PRF photometry is the background flux levels.
We can either estimate it beforehand and subtract it from the target
fluxes or we can let the background be a free parameter during the
estimation process. We will choose the latter here, because we will
assume that our data comes from Poisson distributions. Therefore, we
want the pixel values to be positive everywhere. And, more precisely,
remember that the subtraction of two Poisson random variables is not a
Poisson rv. Therefore, subtracting any value would break our statistical
assumption.</p>
<p>In any case, let’s take a look at the background levels using the
<code class="docutils literal"><span class="pre">estimate_background_per_pixel</span></code> method from <code class="docutils literal"><span class="pre">KeplerTargetPixelFile</span></code>
class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>bkg = tpf.estimate_bkg_per_pixel(method=&#39;mode&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[17, 4])
plt.plot(tpf.time, bkg, &#39;ko&#39;, markersize=2)
plt.xlabel(&quot;Time&quot;)
plt.ylabel(&quot;Flux&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x11c7cef28&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_35_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_35_1.png" />
</div>
</div>
<p>Ooops! Looks like there is something funny happening on that frame
because the background levels are way bellow zero. Let’s plot the pixel
data to see what’s going on:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>funny_cadence = np.argwhere(bkg &lt; 0)[0][0]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>tpf.plot(frame=funny_cadence)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_38_0.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_38_0.png" />
</div>
</div>
<p>Ok, we see that there is something unusual here. Let’s just ignore this
cadence for now and move on to our PRF photometry.</p>
<p>Let’s redraw the background light curve using more meaningful bounds:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[17, 4])
plt.plot(tpf.time, bkg, &#39;ko&#39;, markersize=2)
plt.xlabel(&quot;Time&quot;)
plt.ylabel(&quot;Flux&quot;)
plt.ylim(2150, 2400)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(2150, 2400)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_41_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_41_1.png" />
</div>
</div>
<p>Now, let’s create our PRF model using the <code class="docutils literal"><span class="pre">SimpleKeplerPRF</span></code> class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>sprf = SimpleKeplerPRF(tpf.channel, tpf.shape[1:], tpf.column, tpf.row)
</pre></div>
</div>
</div>
<p>This is a simple model based on the PRF calibration data. It depends on
the channel and the dimensions of the target pixel file that we want to
model. This model is parametrized by stellar positions and flux.</p>
<p>To combine one or more PRF models and a background model, we can use the
<code class="docutils literal"><span class="pre">SceneModel</span></code> class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>scene = SceneModel(prfs=[sprf] * 2)
</pre></div>
</div>
</div>
<p>Note that this class takes a list of PRF objects as required inputs.
Additionally, a parameter named <code class="docutils literal"><span class="pre">bkg_model</span></code> can be used to model the
background variations. The default is a constant value for every frame.</p>
<p>Now that we have taken a look at the data and created our model, let’s
put our assumptions on the table by defining a prior distribution for
the parameters.</p>
<p>Let’s choose a uniform prior for the whole parameter space. We can do
that using the <code class="docutils literal"><span class="pre">UniformPrior</span></code> class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>prior = UniformPrior(lb=[10e3, 940., 877., 10e3, 943., 874., 1e3],
                     ub=[60e3, 944., 880., 60e3, 947., 877., 4e3])
</pre></div>
</div>
</div>
<p>This class takes two parameters: <code class="docutils literal"><span class="pre">lb</span></code>, <code class="docutils literal"><span class="pre">ub</span></code>. <code class="docutils literal"><span class="pre">lb</span></code> stands for lower
bound and <code class="docutils literal"><span class="pre">ub</span></code> for upper bound. The order of those values should
correspond to the order of the parameters in our model. For example, an
object from <code class="docutils literal"><span class="pre">SimpleKeplerPRF</span></code> takes <code class="docutils literal"><span class="pre">flux</span></code>, <code class="docutils literal"><span class="pre">center_col</span></code>, and
<code class="docutils literal"><span class="pre">center_row</span></code>. Therefore, we need to define the prior values on that
same order. And since we have two targets, that results in six
parameters that have to be defined. The last parameter is the background
constant.</p>
<p>Let’s visualize our model evaluated at the mean value given by our prior
probability:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>scene.plot(*prior.mean)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_53_0.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_53_0.png" />
</div>
</div>
<p>Now, we can feed both the <code class="docutils literal"><span class="pre">SceneModel</span></code> and the <code class="docutils literal"><span class="pre">UniformPrior</span></code>
objects to the <code class="docutils literal"><span class="pre">PRFPhotometry</span></code> class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>phot = PRFPhotometry(scene_model=scene, prior=prior)
</pre></div>
</div>
</div>
<p>Finally, we use the <code class="docutils literal"><span class="pre">fit</span></code> method in which we have to pass the pixel
data <code class="docutils literal"><span class="pre">tpf.flux</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>opt_params = phot.fit(tpf.flux)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
  0%|          | 0/1255 [00:00&lt;?, ?it/s]/Users/jvmirca/anaconda3/lib/python3.6/site-packages/autograd/core.py:82: RuntimeWarning: invalid value encountered in log
  result_value = self.fun(*argvals, **kwargs)
/Users/jvmirca/anaconda3/lib/python3.6/site-packages/scipy/optimize/optimize.py:1927: RuntimeWarning: invalid value encountered in double_scalars
  tmp2 = (x - v) * (fx - fw)
 30%|██▉       | 373/1255 [00:17&lt;00:37, 23.45it/s]/Users/jvmirca/anaconda3/lib/python3.6/site-packages/scipy/optimize/optimize.py:1928: RuntimeWarning: invalid value encountered in double_scalars
  p = (x - v) * tmp2 - (x - w) * tmp1
/Users/jvmirca/anaconda3/lib/python3.6/site-packages/scipy/optimize/optimize.py:1929: RuntimeWarning: invalid value encountered in double_scalars
  tmp2 = 2.0 * (tmp2 - tmp1)
100%|██████████| 1255/1255 [00:52&lt;00:00, 25.19it/s]
</pre></div></div>
</div>
<p>Note that our Poisson likelihood assumption is embedded in the
<code class="docutils literal"><span class="pre">PRFPhotometry</span></code> class. That can be changed while creating
<code class="docutils literal"><span class="pre">PRFPhotometry</span></code> through the <code class="docutils literal"><span class="pre">loss_function</span></code> parameter.</p>
<p>Now, let’s retrieve the fitted parameters which are store in the
<code class="docutils literal"><span class="pre">opt_params</span></code> attribute:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>flux_1 = opt_params[:, 0]
xcenter_1 = opt_params[:, 1]
ycenter_1 = opt_params[:, 2]
flux_2 = opt_params[:, 3]
xcenter_2 = opt_params[:, 4]
ycenter_2 = opt_params[:, 5]
bkg_hat = opt_params[:, 6]
</pre></div>
</div>
</div>
<p>Let’s visualize the parameters as a function of time:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, flux_1, &#39;o&#39;, markersize=2)
plt.ylabel(&quot;Flux&quot;)
plt.xlabel(&quot;Time&quot;)
plt.ylim()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(20325.170959279698, 34776.171872301245)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_62_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_62_1.png" />
</div>
</div>
<p>Oops! That outlier is probably the funny cadence we identified before:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>outlier = np.argwhere(flux_1 &gt; 25000)[0][0]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>outlier == funny_cadence
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[30]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>True
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, flux_1, &#39;o&#39;, markersize=2)
plt.ylabel(&quot;Flux&quot;)
plt.xlabel(&quot;Time&quot;)
plt.ylim(20500, 22000)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(20500, 22000)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_66_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_66_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, xcenter_1, &#39;o&#39;, markersize=2)
plt.ylabel(&quot;Column position&quot;)
plt.xlabel(&quot;Time&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x10ada09b0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_67_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_67_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, ycenter_1, &#39;o&#39;, markersize=2)
plt.ylabel(&quot;Row position&quot;)
plt.xlabel(&quot;Time&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[33]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x11bf7f9b0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_68_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_68_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, flux_2, &#39;ro&#39;, markersize=2)
plt.ylim(17000, 19000)
plt.ylabel(&quot;Flux&quot;)
plt.xlabel(&quot;Time&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[34]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x11bf6d400&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_69_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_69_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, xcenter_2, &#39;ro&#39;, markersize=2)
plt.ylabel(&quot;Column position&quot;)
plt.xlabel(&quot;Time&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[35]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x10d03dc18&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_70_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_70_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, ycenter_2, &#39;ro&#39;, markersize=2)
plt.ylabel(&quot;Row position&quot;)
plt.xlabel(&quot;Time&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[36]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x11d13fef0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_71_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_71_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.figure(figsize=[18, 4])
plt.plot(tpf.time, bkg_hat, &#39;ko&#39;, markersize=2)
plt.ylabel(&quot;Background Flux&quot;)
plt.xlabel(&quot;Time&quot;)
plt.ylim(2350, 2650)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[37]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(2350, 2650)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_72_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_72_1.png" />
</div>
</div>
<p>We can retrieve the residuals using the <code class="docutils literal"><span class="pre">get_residuals</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>residuals = phot.get_residuals()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.imshow(residuals[100], origin=&#39;lower&#39;)
plt.colorbar()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[39]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.colorbar.Colorbar at 0x10add9048&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_75_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_75_1.png" />
</div>
</div>
<p>We can also get the pixels time series for every single model as shown
below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>prf_1 = np.array([scene.prfs[0](*phot.opt_params[i, 0:3])
                  for i in range(len(tpf.time))])
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>prf_2 = np.array([scene.prfs[1](*phot.opt_params[i, 3:6])
                  for i in range(len(tpf.time))])
</pre></div>
</div>
</div>
<p>Let’s then visualize the single models:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.imshow(prf_1[100], origin=&#39;lower&#39;, extent=(940, 949, 872, 880))
plt.colorbar()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[42]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.colorbar.Colorbar at 0x11c2aada0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_80_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_80_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>plt.imshow(prf_2[100], origin=&#39;lower&#39;, extent=(940, 949, 872, 880))
plt.colorbar()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[43]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.colorbar.Colorbar at 0x11c254668&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_81_1.png" src="../../../_images/tutorials_ipython_notebooks_psfphotometry_c9-prf-fitting_81_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright PyKE Developers and Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>