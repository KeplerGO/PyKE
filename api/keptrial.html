

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>keptrial: calculate best period and error estimate from time series &mdash; PyKE 3.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyKE 3.0.0 documentation" href="../index.html"/>
        <link rel="up" title="List of PyKE tools" href="index.html"/>
        <link rel="next" title="keptrim: trim pixels from Target Pixel Files" href="keptrim.html"/>
        <link rel="prev" title="keptimefix: correct a time stamp error in the target pixel files" href="keptimefix.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PyKE
          

          
            
            <img src="../_static/pyke-white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../overview.html">PyKE tasks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html#calling-tasks-from-python">Calling tasks from Python</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../overview.html#calling-tasks-from-a-terminal">Calling tasks from a terminal</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">List of PyKE tools</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="kepbls.html"><strong>kepbls</strong>: perform Box-Least Square searches for periodic exoplanet transits</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepclip.html"><strong>kepclip</strong>: remove unwanted time ranges from Kepler time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepconvert.html"><strong>kepconvert</strong>: convert Kepler FITS time series to or from a different file format</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepcotrend.html"><strong>kepcotrend</strong>: remove systematic trends Kepler light curves using cotrending basis vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdetrend.html"><strong>kepdetrend</strong>: detrend aperture photometry data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdiffim.html"><strong>kepdiffim</strong>: difference imaging of pixels within a target mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdraw.html"><strong>kepdraw</strong>: interactive plotting of Kepler time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdynamic.html"><strong>kepdynamic</strong>: construct a dynamic power spectrum from Kepler time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepextract.html"><strong>kepextract</strong>: create a light curve from a target pixel file by summing user-selected pixels</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepffi.html"><strong>kepffi</strong>: display a portion of a Full Frame Image (FFI) and define custom target apertures</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepfilter.html"><strong>kepfilter</strong>: bandpass filtering of Kepler light curve data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepflatten.html"><strong>kepflatten</strong>: remove low frequency variability from time-series, preserve transits and flares</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepfold.html"><strong>kepfold</strong>: phase-fold light curve data on linear ephemeris</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepft.html"><strong>kepft</strong>: calculate and store a Fourier Transform from a Kepler time series</a></li>
<li class="toctree-l4"><a class="reference internal" href="kephead.html"><strong>kephead</strong>: search for and list FITS keywords in Kepler data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepimages.html"><strong>kepimages</strong>: create a series of separate FITS image files from a Target Pixel File</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepmask.html"><strong>kepmask</strong>: plot, create or edit custom target masks for target pixel files</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepoutlier.html"><strong>kepoutlier</strong>: remove or replace statistical outliers from time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="keppca.html"><strong>keppca</strong>: perform principal component analysis upon a target pixel file</a></li>
<li class="toctree-l4"><a class="reference internal" href="keppixseries.html"><strong>keppixseries</strong>: individual time series photometry for all pixels within a target mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepprf.html"><strong>kepprf</strong>: fit a PSF model to a specific image within a Target Pixel File</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepprfphot.html"><strong>kepprfphot</strong>: fit a PSF model to time series observations within a Target Pixel File</a></li>
<li class="toctree-l4"><a class="reference internal" href="keprange.html"><strong>keprange</strong>: define time ranges interactively for use with other PyKE tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepsff.html"><strong>kepsff</strong>: remove motion-correlated noise from aperture light curve data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepsmooth.html"><strong>kepsmooth</strong>: smooth light curves by convolution with a choice of analytical function</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepstddev.html"><strong>kepstddev</strong>: calculate Combined Differential Photometric Precision for a time series light curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepstitch.html"><strong>kepstitch</strong>: append short cadence months and/or long cadence quarters</a></li>
<li class="toctree-l4"><a class="reference internal" href="keptimefix.html"><strong>keptimefix</strong>: correct a time stamp error in the target pixel files</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#"><strong>keptrial</strong>: calculate best period and error estimate from time series</a></li>
<li class="toctree-l4"><a class="reference internal" href="keptrim.html"><strong>keptrim</strong>: trim pixels from Target Pixel Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepwindow.html"><strong>kepwindow</strong>: calculate and store the window function for a Kepler time series</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Photometry tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PyKE</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../overview.html">PyKE tasks</a> &raquo;</li>
      
          <li><a href="index.html">List of PyKE tools</a> &raquo;</li>
      
    <li><strong>keptrial</strong>: calculate best period and error estimate from time series</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/keptrial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="keptrial-calculate-best-period-and-error-estimate-from-time-series">
<h1><strong>keptrial</strong>: calculate best period and error estimate from time series<a class="headerlink" href="#keptrial-calculate-best-period-and-error-estimate-from-time-series" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyke.keptrial.keptrial">
<code class="descclassname">pyke.keptrial.</code><code class="descname">keptrial</code><span class="sig-paren">(</span><em>infile</em>, <em>outfile=None</em>, <em>datacol='SAP_FLUX'</em>, <em>errcol='SAP_FLUX_ERR'</em>, <em>fmin=0.1</em>, <em>fmax=50</em>, <em>nfreq=10</em>, <em>method='ft'</em>, <em>ntrials=1000</em>, <em>plot=False</em>, <em>overwrite=False</em>, <em>verbose=False</em>, <em>logfile='keptrial.log'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/keptrial.html#keptrial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.keptrial.keptrial" title="Permalink to this definition">¶</a></dt>
<dd><p>keptrial – Calculate best period and error estimate from time series</p>
<p><code class="docutils literal"><span class="pre">keptrial</span></code> measures the strongest period within the frequency range
<span class="math">\(fmin\)</span> to <span class="math">\(fmax\)</span> and estimates 1-<span class="math">\(\sigma\)</span> error
associated with that period. The error estimate is performed by
constructing ntrial new light curves from the original data provided in
datacol and adjusting each individual data point according to a random
number generator and a shot noise model. While a shot noise model is not
uniformly applicable to all Kepler targets it provides a useful 1st order
estimate for most. A power spectrum is calculated for each light curve
using a user-specified method and the highest peak in each power spectrum
recorded. The distribution of peaks is fit by a normal function, the
centroid is adopted as the best period and 1-standard deviation error is
taken from the standard deviation. A confidence limit is recorded as the
range within which all trial periods fall. While this is termed a ‘100%’
confidence limit, this only refers to the total number of trials rather
than formal confidence.</p>
<p>The larger the number of <strong>ntrials</strong>, the more robust the result. The
values of nfreq and ntrial have to be chosen carefully to avoid excessive
run times. The values of <strong>fmin</strong>, <strong>fmax</strong> and <strong>nfreq</strong> have to be
chosen carefully in order to provide a sensible measure of period and
error. It is recommended that <code class="docutils literal"><span class="pre">kepperiodogram</span></code> be used to estimate the period and
error before attempting to use <code class="docutils literal"><span class="pre">keptrial</span></code>. An exercise of trial and error
will most-likely be needed to choose a permutation of <span class="math">\(fmin\)</span>,
<span class="math">\(fmax\)</span> and <span class="math">\(nfreq\)</span> that resolves the period distribution over a
significant number of frequency bins. If requested, the distribution and
normal fit are plotted. The plot updates after every ntrial iteration,
partly to relieve boredom, and partly for the user to assess whether they
are using the correct permutation of input parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>infile</strong> : str</p>
<blockquote>
<div><p>The name of a MAST standard format FITS file containing a Kepler light
curve within the first data extension.</p>
</div></blockquote>
<p><strong>outfile</strong> : str</p>
<blockquote>
<div><p>The name of the output FITS file with a new extension containing the
results of a Monte Carlo period analysis.</p>
</div></blockquote>
<p><strong>datacol</strong> : str</p>
<blockquote>
<div><p>The column name containing data stored within extension 1 of infile.
This data is the input data for periodogram. Typically this name is
SAP_FLUX (Simple Aperture Photometry fluxes), but any data column within
extension 1 of the FITS file can be used provided it is coupled to an
error column name using errcol.</p>
</div></blockquote>
<p><strong>errcol</strong> : str</p>
<blockquote>
<div><p>The uncertainty data coupled to datacol. Typically this column is
called SAP_FLUX_ERR.</p>
</div></blockquote>
<p><strong>fmin</strong> : float [1/day]</p>
<blockquote>
<div><p>The minimum frequency on which each power spectrum will be calculated.</p>
</div></blockquote>
<p><strong>fmax</strong> : float [1/day]</p>
<blockquote>
<div><p>The maximum frequency on which each power spectrum will be calculated.</p>
</div></blockquote>
<p><strong>nfreq</strong> : int</p>
<blockquote>
<div><p>The number of uniform frequency steps between fmin and fmax over which
the power spectrum will be calculated.</p>
</div></blockquote>
<p><strong>method</strong> : str</p>
<blockquote>
<div><p>Choose a method for calculating the power spectrum. Currently, only
‘ft’, a discrete Fourier transform, is available.</p>
</div></blockquote>
<p><strong>ntrials</strong> : int</p>
<blockquote>
<div><p>The number of Monte Carlo trials required before calculating the best
periods, period uncertainty and confidence in the measurement.</p>
</div></blockquote>
<p><strong>plot</strong> : bool</p>
<blockquote>
<div><p>Plot the output window function?</p>
</div></blockquote>
<p><strong>overwrite</strong> : bool</p>
<blockquote>
<div><p>Overwrite the output file?</p>
</div></blockquote>
<p><strong>verbose</strong> : bool</p>
<blockquote>
<div><p>Print informative messages and warnings to the shell and logfile?</p>
</div></blockquote>
<p><strong>logfile</strong> : str</p>
<blockquote class="last">
<div><p>Name of the logfile containing error and warning messages.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="keptrim.html" class="btn btn-neutral float-right" title="keptrim: trim pixels from Target Pixel Files" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="keptimefix.html" class="btn btn-neutral" title="keptimefix: correct a time stamp error in the target pixel files" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright PyKE Developers and Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>