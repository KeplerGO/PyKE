

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lightcurve &mdash; PyKE 3.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyKE 3.0.0 documentation" href="../index.html"/>
        <link rel="up" title="API documentation" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PyKE
          

          
            
            <img src="../_static/pyke-white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ipython_notebooks/whatsnew31.html">What’s new in PyKE 3.1?</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="targetpixelfile.html">Target Pixel File</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lightcurve</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inheritance-diagram">Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="prf.html">Point Spread Function Photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tasks.html">PyKE tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Photometry tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyKE</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">API documentation</a> &raquo;</li>
        
      <li>Lightcurve</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/lightcurve.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-pyke.lightcurve">
<span id="lightcurve"></span><h1>Lightcurve<a class="headerlink" href="#module-pyke.lightcurve" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pyke.lightcurve.LightCurve">
<em class="property">class </em><code class="descclassname">pyke.lightcurve.</code><code class="descname">LightCurve</code><span class="sig-paren">(</span><em>time</em>, <em>flux</em>, <em>flux_err=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements a simple class for a generic light curve.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>time</strong></td>
<td>(array-like) Time measurements</td>
</tr>
<tr class="row-even"><td><strong>flux</strong></td>
<td>(array-like) Data flux for every time point</td>
</tr>
<tr class="row-odd"><td><strong>flux_err</strong></td>
<td>(array-like) Uncertainty on each flux data point</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.bin" title="pyke.lightcurve.LightCurve.bin"><code class="xref py py-obj docutils literal"><span class="pre">bin</span></code></a>([binsize,&nbsp;method])</td>
<td>Bins a lightcurve using a function defined by <cite>method</cite> on blocks of samples of size <cite>binsize</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.cdpp" title="pyke.lightcurve.LightCurve.cdpp"><code class="xref py py-obj docutils literal"><span class="pre">cdpp</span></code></a>([transit_duration,&nbsp;savgol_window,&nbsp;…])</td>
<td>Estimate the CDPP noise metric using the Savitzky-Golay (SG) method.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.flatten" title="pyke.lightcurve.LightCurve.flatten"><code class="xref py py-obj docutils literal"><span class="pre">flatten</span></code></a>([window_length,&nbsp;polyorder,&nbsp;return_trend])</td>
<td>Removes low frequency trend using scipy’s Savitzky-Golay filter.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.fold" title="pyke.lightcurve.LightCurve.fold"><code class="xref py py-obj docutils literal"><span class="pre">fold</span></code></a>(period[,&nbsp;phase])</td>
<td>Folds the lightcurve at a specified <code class="docutils literal"><span class="pre">period</span></code> and <code class="docutils literal"><span class="pre">phase</span></code>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.plot" title="pyke.lightcurve.LightCurve.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>([ax,&nbsp;normalize,&nbsp;xlabel,&nbsp;ylabel,&nbsp;title,&nbsp;…])</td>
<td>Plots the light curve.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.remove_nans" title="pyke.lightcurve.LightCurve.remove_nans"><code class="xref py py-obj docutils literal"><span class="pre">remove_nans</span></code></a>()</td>
<td>Removes cadences where the flux is NaN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.remove_outliers" title="pyke.lightcurve.LightCurve.remove_outliers"><code class="xref py py-obj docutils literal"><span class="pre">remove_outliers</span></code></a>([sigma])</td>
<td>Removes outlier flux values using sigma-clipping.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.stitch" title="pyke.lightcurve.LightCurve.stitch"><code class="xref py py-obj docutils literal"><span class="pre">stitch</span></code></a>(*others)</td>
<td>Stitches LightCurve objects.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.LightCurve.to_csv" title="pyke.lightcurve.LightCurve.to_csv"><code class="xref py py-obj docutils literal"><span class="pre">to_csv</span></code></a>()</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyke.lightcurve.LightCurve.bin">
<code class="descname">bin</code><span class="sig-paren">(</span><em>binsize=13</em>, <em>method='mean'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.bin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bins a lightcurve using a function defined by <cite>method</cite>
on blocks of samples of size <cite>binsize</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>binsize</strong> : int</p>
<blockquote>
<div><p>Number of cadences to include in every bin.</p>
</div></blockquote>
<p><strong>method: str, one of ‘mean’ or ‘median’</strong></p>
<blockquote>
<div><p>The summary statistic to return for each bin. Default: ‘mean’.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>binned_lc</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>Binned lightcurve.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>If the ratio between the lightcurve length and the binsize is not
a whole number, then the remainder of the data points will be
ignored.</li>
<li>If the original lightcurve contains flux uncertainties (flux_err),
the binned lightcurve will report the root-mean-square error.
If no uncertainties are included, the binned curve will return the
standard deviation of the data.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.cdpp">
<code class="descname">cdpp</code><span class="sig-paren">(</span><em>transit_duration=13</em>, <em>savgol_window=101</em>, <em>savgol_polyorder=2</em>, <em>sigma_clip=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.cdpp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.cdpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the CDPP noise metric using the Savitzky-Golay (SG) method.</p>
<p>A common estimate of the noise in a lightcurve is the scatter that
remains after all long term trends have been removed. This is the idea
behind the Combined Differential Photometric Precision (CDPP) metric.
The official Kepler Pipeline computes this metric using a wavelet-based
algorithm to calculate the signal-to-noise of the specific waveform of
transits of various durations. In this implementation, we use the
simpler “sgCDPP proxy algorithm” discussed by Gilliland et al
(2011ApJS..197….6G) and Van Cleve et al (2016PASP..128g5002V).</p>
<dl class="docutils">
<dt>The steps of this algorithm are:</dt>
<dd><ol class="first last arabic simple">
<li>Remove low frequency signals using a Savitzky-Golay filter with
window length <cite>savgol_window</cite> and polynomial order <cite>savgol_polyorder</cite>.</li>
<li>Remove outliers by rejecting data points which are separated from
the mean by <cite>sigma_clip</cite> times the standard deviation.</li>
<li>Compute the standard deviation of a running mean with
a configurable window length equal to <cite>transit_duration</cite>.</li>
</ol>
</dd>
</dl>
<p>We use a running mean (as opposed to block averaging) to strongly
attenuate the signal above 1/transit_duration whilst retaining
the original frequency sampling.  Block averaging would set the Nyquist
limit to 1/transit_duration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>transit_duration</strong> : int, optional</p>
<blockquote>
<div><p>The transit duration in cadences. This is the length of the window
used to compute the running mean. The default is 13, which
corresponds to a 6.5 hour transit in data sampled at 30-min cadence.</p>
</div></blockquote>
<p><strong>savgol_window</strong> : int, optional</p>
<blockquote>
<div><p>Width of Savitsky-Golay filter in cadences (odd number).
Default value 101 (2.0 days in Kepler Long Cadence mode).</p>
</div></blockquote>
<p><strong>savgol_polyorder</strong> : int, optional</p>
<blockquote>
<div><p>Polynomial order of the Savitsky-Golay filter.
The recommended value is 2.</p>
</div></blockquote>
<p><strong>sigma_clip</strong> : float, optional</p>
<blockquote>
<div><p>The number of standard deviations to use for clipping outliers.
The default is 5.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cdpp</strong> : float</p>
<blockquote class="last">
<div><p>Savitzky-Golay CDPP noise metric in units parts-per-million (ppm).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This implementation is adapted from the Matlab version used by
Jeff van Cleve but lacks the normalization factor used there:
svn+ssh://murzim/repo/so/trunk/Develop/jvc/common/compute_SG_noise.m</p>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>window_length=101</em>, <em>polyorder=3</em>, <em>return_trend=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes low frequency trend using scipy’s Savitzky-Golay filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>window_length</strong> : int</p>
<blockquote>
<div><p>The length of the filter window (i.e. the number of coefficients).
<code class="docutils literal"><span class="pre">window_length</span></code> must be a positive odd integer.</p>
</div></blockquote>
<p><strong>polyorder</strong> : int</p>
<blockquote>
<div><p>The order of the polynomial used to fit the samples. <code class="docutils literal"><span class="pre">polyorder</span></code>
must be less than window_length.</p>
</div></blockquote>
<p><strong>return_trend</strong> : bool</p>
<blockquote>
<div><p>If <cite>True</cite>, the method will return a tuple of two elements
(flattened_lc, trend_lc) where trend_lc is the removed trend.</p>
</div></blockquote>
<p><strong>**kwargs</strong> : dict</p>
<blockquote>
<div><p>Dictionary of arguments to be passed to <cite>scipy.signal.savgol_filter</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>flatten_lc</strong> : LightCurve object</p>
<blockquote>
<div><p>Flattened lightcurve.</p>
</div></blockquote>
<p>If <cite>return_trend</cite> is <cite>True</cite>, the method will also return:</p>
<p><strong>trend_lc</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>Trend in the lightcurve data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.fold">
<code class="descname">fold</code><span class="sig-paren">(</span><em>period</em>, <em>phase=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.fold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.fold" title="Permalink to this definition">¶</a></dt>
<dd><p>Folds the lightcurve at a specified <code class="docutils literal"><span class="pre">period</span></code> and <code class="docutils literal"><span class="pre">phase</span></code>.</p>
<p>This method returns a new <code class="docutils literal"><span class="pre">LightCurve</span></code> object in which the time
values range between -0.5 to +0.5.  Data points which occur exactly
at <code class="docutils literal"><span class="pre">phase</span></code> or an integer multiple of <cite>phase + n*period</cite> have time
value 0.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>period</strong> : float</p>
<blockquote>
<div><p>The period upon which to fold.</p>
</div></blockquote>
<p><strong>phase</strong> : float, optional</p>
<blockquote>
<div><p>Time reference point.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>folded_lightcurve</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>A new <code class="docutils literal"><span class="pre">LightCurve</span></code> in which the data are folded and sorted by
phase.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>normalize=True</em>, <em>xlabel='Time - 2454833 (days)'</em>, <em>ylabel='Normalized Flux'</em>, <em>title=None</em>, <em>color='#363636'</em>, <em>linestyle=''</em>, <em>fill=False</em>, <em>grid=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the light curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ax</strong> : matplotlib.axes._subplots.AxesSubplot</p>
<blockquote>
<div><p>A matplotlib axes object to plot into. If no axes is provided,
a new one be generated.</p>
</div></blockquote>
<p><strong>normalize</strong> : bool</p>
<blockquote>
<div><p>Normalized the lightcurve</p>
</div></blockquote>
<p><strong>xlabel</strong> : str</p>
<blockquote>
<div><p>Plot x axis label</p>
</div></blockquote>
<p><strong>ylabel</strong> : str</p>
<blockquote>
<div><p>Plot y axis label</p>
</div></blockquote>
<p><strong>title</strong> : str</p>
<blockquote>
<div><p>Plot set_title</p>
</div></blockquote>
<p><strong>color: str</strong></p>
<blockquote>
<div><p>Color to plot flux points</p>
</div></blockquote>
<p><strong>fill: bool</strong></p>
<blockquote>
<div><p>Shade the region between 0 and flux</p>
</div></blockquote>
<p><strong>grid: bool</strong></p>
<blockquote>
<div><p>Add a grid to the plot</p>
</div></blockquote>
<p><strong>**kwargs</strong> : dict</p>
<blockquote>
<div><p>Dictionary of arguments to be passed to <cite>matplotlib.pyplot.plot</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ax</strong> : matplotlib.axes._subplots.AxesSubplot</p>
<blockquote class="last">
<div><p>The matplotlib axes object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.remove_nans">
<code class="descname">remove_nans</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.remove_nans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.remove_nans" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes cadences where the flux is NaN.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>clean_lightcurve</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>A new <code class="docutils literal"><span class="pre">LightCurve</span></code> from which NaNs fluxes have been removed.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.remove_outliers">
<code class="descname">remove_outliers</code><span class="sig-paren">(</span><em>sigma=5.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.remove_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.remove_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes outlier flux values using sigma-clipping.</p>
<p>This method returns a new LightCurve object from which flux values
are removed if they are separated from the mean flux by <cite>sigma</cite> times
the standard deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sigma</strong> : float</p>
<blockquote>
<div><p>The number of standard deviations to use for clipping outliers.
Defaults to 5.</p>
</div></blockquote>
<p><strong>**kwargs</strong> : dict</p>
<blockquote>
<div><p>Dictionary of arguments to be passed to <cite>astropy.stats.sigma_clip</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>clean_lightcurve</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>A new <code class="docutils literal"><span class="pre">LightCurve</span></code> in which outliers have been removed.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.stitch">
<code class="descname">stitch</code><span class="sig-paren">(</span><em>*others</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.stitch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.stitch" title="Permalink to this definition">¶</a></dt>
<dd><p>Stitches LightCurve objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>*others</strong> : LightCurve objects</p>
<blockquote>
<div><p>Light curves to be stitched.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>stitched_lc</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>Stitched light curve.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.LightCurve.to_csv">
<code class="descname">to_csv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#LightCurve.to_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.LightCurve.to_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyke.lightcurve.KeplerLightCurve">
<em class="property">class </em><code class="descclassname">pyke.lightcurve.</code><code class="descname">KeplerLightCurve</code><span class="sig-paren">(</span><em>time</em>, <em>flux</em>, <em>flux_err=None</em>, <em>centroid_col=None</em>, <em>centroid_row=None</em>, <em>quality=None</em>, <em>quality_bitmask=None</em>, <em>channel=None</em>, <em>campaign=None</em>, <em>quarter=None</em>, <em>mission=None</em>, <em>cadenceno=None</em>, <em>keplerid=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a light curve class for NASA’s Kepler and K2 missions.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>time</strong></td>
<td>(array-like) Time measurements</td>
</tr>
<tr class="row-even"><td><strong>flux</strong></td>
<td>(array-like) Data flux for every time point</td>
</tr>
<tr class="row-odd"><td><strong>flux_err</strong></td>
<td>(array-like) Uncertainty on each flux data point</td>
</tr>
<tr class="row-even"><td><strong>centroid_col, centroid_row</strong></td>
<td>(array-like, array-like) Centroid column and row coordinates as a function of time</td>
</tr>
<tr class="row-odd"><td><strong>quality</strong></td>
<td>(array-like) Array indicating the quality of each data point</td>
</tr>
<tr class="row-even"><td><strong>quality_bitmask</strong></td>
<td>(int) Bitmask specifying quality flags of cadences that should be ignored</td>
</tr>
<tr class="row-odd"><td><strong>channel</strong></td>
<td>(int) Channel number</td>
</tr>
<tr class="row-even"><td><strong>campaign</strong></td>
<td>(int) Campaign number</td>
</tr>
<tr class="row-odd"><td><strong>quarter</strong></td>
<td>(int) Quarter number</td>
</tr>
<tr class="row-even"><td><strong>mission</strong></td>
<td>(str) Mission name</td>
</tr>
<tr class="row-odd"><td><strong>cadenceno</strong></td>
<td>(array-like) Cadence numbers corresponding to every time measurement</td>
</tr>
<tr class="row-even"><td><strong>keplerid</strong></td>
<td>(int) Kepler ID number</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">bin</span></code>([binsize,&nbsp;method])</td>
<td>Bins a lightcurve using a function defined by <cite>method</cite> on blocks of samples of size <cite>binsize</cite>.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">cdpp</span></code>([transit_duration,&nbsp;savgol_window,&nbsp;…])</td>
<td>Estimate the CDPP noise metric using the Savitzky-Golay (SG) method.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.KeplerLightCurve.correct" title="pyke.lightcurve.KeplerLightCurve.correct"><code class="xref py py-obj docutils literal"><span class="pre">correct</span></code></a>([method])</td>
<td>Corrects a lightcurve for motion-dependent systematic errors.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">flatten</span></code>([window_length,&nbsp;polyorder,&nbsp;return_trend])</td>
<td>Removes low frequency trend using scipy’s Savitzky-Golay filter.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">fold</span></code>(period[,&nbsp;phase])</td>
<td>Folds the lightcurve at a specified <code class="docutils literal"><span class="pre">period</span></code> and <code class="docutils literal"><span class="pre">phase</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code>([ax,&nbsp;normalize,&nbsp;xlabel,&nbsp;ylabel,&nbsp;title,&nbsp;…])</td>
<td>Plots the light curve.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">remove_nans</span></code>()</td>
<td>Removes cadences where the flux is NaN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">remove_outliers</span></code>([sigma])</td>
<td>Removes outlier flux values using sigma-clipping.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">stitch</span></code>(*others)</td>
<td>Stitches LightCurve objects.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">to_csv</span></code>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.KeplerLightCurve.to_fits" title="pyke.lightcurve.KeplerLightCurve.to_fits"><code class="xref py py-obj docutils literal"><span class="pre">to_fits</span></code></a>()</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyke.lightcurve.KeplerLightCurve.correct">
<code class="descname">correct</code><span class="sig-paren">(</span><em>method='sff'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurve.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurve.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects a lightcurve for motion-dependent systematic errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>method</strong> : str</p>
<blockquote>
<div><p>Method used to correct the lightcurve.
Right now only ‘sff’ (Vanderburg’s Self-Flat Fielding) is supported.</p>
</div></blockquote>
<p><strong>kwargs</strong> : dict</p>
<blockquote>
<div><p>Dictionary of keyword arguments to be passed to the function
defined by <cite>method</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>new_lc</strong> : KeplerLightCurve object</p>
<blockquote class="last">
<div><p>Corrected lightcurve</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerLightCurve.to_fits">
<code class="descname">to_fits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurve.to_fits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurve.to_fits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyke.lightcurve.KeplerLightCurveFile">
<em class="property">class </em><code class="descclassname">pyke.lightcurve.</code><code class="descname">KeplerLightCurveFile</code><span class="sig-paren">(</span><em>path</em>, <em>quality_bitmask=1130927</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurveFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a class for a given light curve FITS file from NASA’s Kepler and
K2 missions.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>path</strong></td>
<td>(str) Directory path or url to a lightcurve FITS file.</td>
</tr>
<tr class="row-even"><td><strong>quality_bitmask</strong></td>
<td>(str or int) Bitmask specifying quality flags of cadences that should be ignored. If a string is passed, it has the following meaning:  * default: recommended quality mask * hard: removes more flags, known to remove good data * hardest: removes all data that has been flagged</td>
</tr>
<tr class="row-odd"><td><strong>kwargs</strong></td>
<td>(dict) Keyword arguments to be passed to astropy.io.fits.open.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.KeplerLightCurveFile.compute_cotrended_lightcurve" title="pyke.lightcurve.KeplerLightCurveFile.compute_cotrended_lightcurve"><code class="xref py py-obj docutils literal"><span class="pre">compute_cotrended_lightcurve</span></code></a>([cbvs])</td>
<td>Returns a LightCurve object after cotrending the SAP_FLUX against the cotrending basis vectors.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.KeplerLightCurveFile.get_lightcurve" title="pyke.lightcurve.KeplerLightCurveFile.get_lightcurve"><code class="xref py py-obj docutils literal"><span class="pre">get_lightcurve</span></code></a>(flux_type[,&nbsp;centroid_type])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.KeplerLightCurveFile.header" title="pyke.lightcurve.KeplerLightCurveFile.header"><code class="xref py py-obj docutils literal"><span class="pre">header</span></code></a>([ext])</td>
<td>Header of the object at extension <cite>ext</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.KeplerLightCurveFile.plot" title="pyke.lightcurve.KeplerLightCurveFile.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>([plottype])</td>
<td>Plot all the flux types in a light curve.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.PDCSAP_FLUX">
<code class="descname">PDCSAP_FLUX</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.PDCSAP_FLUX" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a KeplerLightCurve object for PDCSAP_FLUX</p>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.SAP_FLUX">
<code class="descname">SAP_FLUX</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.SAP_FLUX" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a KeplerLightCurve object for SAP_FLUX</p>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.cadenceno">
<code class="descname">cadenceno</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.cadenceno" title="Permalink to this definition">¶</a></dt>
<dd><p>Cadence number</p>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.campaign">
<code class="descname">campaign</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.campaign" title="Permalink to this definition">¶</a></dt>
<dd><p>Campaign number</p>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.channel">
<code class="descname">channel</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Channel number</p>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerLightCurveFile.compute_cotrended_lightcurve">
<code class="descname">compute_cotrended_lightcurve</code><span class="sig-paren">(</span><em>cbvs=[1, 2], **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurveFile.compute_cotrended_lightcurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.compute_cotrended_lightcurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a LightCurve object after cotrending the SAP_FLUX
against the cotrending basis vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cbvs</strong> : list of ints</p>
<blockquote>
<div><p>The list of cotrending basis vectors to fit to the data. For example,
[1, 2] will fit the first two basis vectors.</p>
</div></blockquote>
<p><strong>kwargs</strong> : dict</p>
<blockquote>
<div><p>Dictionary of keyword arguments to be passed to
KeplerCBVCorrector.correct.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>lc</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>CBV flux-corrected lightcurve.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerLightCurveFile.get_lightcurve">
<code class="descname">get_lightcurve</code><span class="sig-paren">(</span><em>flux_type</em>, <em>centroid_type='MOM_CENTR'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurveFile.get_lightcurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.get_lightcurve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerLightCurveFile.header">
<code class="descname">header</code><span class="sig-paren">(</span><em>ext=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurveFile.header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.header" title="Permalink to this definition">¶</a></dt>
<dd><p>Header of the object at extension <cite>ext</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.mission">
<code class="descname">mission</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.mission" title="Permalink to this definition">¶</a></dt>
<dd><p>Mission name</p>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerLightCurveFile.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>plottype=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerLightCurveFile.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all the flux types in a light curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>plottype</strong> : str or list of str</p>
<blockquote class="last">
<div><p>List of FLUX types to plot. Default is to plot all available.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.quarter">
<code class="descname">quarter</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.quarter" title="Permalink to this definition">¶</a></dt>
<dd><p>Quarter number</p>
</dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerLightCurveFile.time">
<code class="descname">time</code><a class="headerlink" href="#pyke.lightcurve.KeplerLightCurveFile.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time measurements</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyke.lightcurve.KeplerCBVCorrector">
<em class="property">class </em><code class="descclassname">pyke.lightcurve.</code><code class="descname">KeplerCBVCorrector</code><span class="sig-paren">(</span><em>lc_file</em>, <em>loss_function=&lt;class 'oktopus.likelihood.LaplacianLikelihood'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerCBVCorrector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerCBVCorrector" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove systematic trends from Kepler light curves by fitting
cotrending basis vectors.</p>
<div class="math">
\[\arg \min_{\bm{\theta} \in \Theta} \sum_{t}|f_{SAP}(t) - \sum_{j=1}^{n}\theta_j v_{j}(t)|^p, p&gt;0, p \in \mathbb{R}\]</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyke</span> <span class="k">import</span> <span class="n">KeplerCBVCorrector</span><span class="p">,</span> <span class="n">KeplerLightCurveFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;https://archive.stsci.edu/missions/kepler/lightcurves/&quot;</span>
<span class="gp">... </span>      <span class="s2">&quot;0084/008462852/kplr008462852-2011073133259_llc.fits&quot;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbv</span> <span class="o">=</span> <span class="n">KeplerCBVCorrector</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> 
<span class="go">Downloading https://archive.stsci.edu/missions/kepler/lightcurves/0084/008462852/kplr008462852-2011073133259_llc.fits [Done]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbv_lc</span> <span class="o">=</span> <span class="n">cbv</span><span class="o">.</span><span class="n">correct</span><span class="p">()</span> 
<span class="go">Downloading http://archive.stsci.edu/missions/kepler/cbv/kplr2011073133259-q08-d25_lcbv.fits [Done]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sap_lc</span> <span class="o">=</span> <span class="n">KeplerLightCurveFile</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">SAP_FLUX</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sap_lc</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">sap_lc</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SAP_FLUX&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbv_lc</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">cbv_lc</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CBV_FLUX&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> 
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>lc_file</strong></td>
<td>(KeplerLightCurveFile object or str) An instance from KeplerLightCurveFile or a path for the .fits file of a NASA’s Kepler/K2 light curve.</td>
</tr>
<tr class="row-even"><td><strong>loss_function</strong></td>
<td>(oktopus.Likelihood subclass) A class that describes a cost function. The default is <code class="xref py py-class docutils literal"><span class="pre">oktopus.LaplacianLikelihood</span></code>, which is tantamount to the L1 norm.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.KeplerCBVCorrector.correct" title="pyke.lightcurve.KeplerCBVCorrector.correct"><code class="xref py py-obj docutils literal"><span class="pre">correct</span></code></a>([cbvs,&nbsp;method,&nbsp;options])</td>
<td>Correct the SAP_FLUX by fitting a number of cotrending basis vectors <cite>cbvs</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.KeplerCBVCorrector.get_cbv_url" title="pyke.lightcurve.KeplerCBVCorrector.get_cbv_url"><code class="xref py py-obj docutils literal"><span class="pre">get_cbv_url</span></code></a>()</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pyke.lightcurve.KeplerCBVCorrector.coeffs">
<code class="descname">coeffs</code><a class="headerlink" href="#pyke.lightcurve.KeplerCBVCorrector.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the fitted coefficients.</p>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerCBVCorrector.correct">
<code class="descname">correct</code><span class="sig-paren">(</span><em>cbvs=[1, 2], method='powell', options={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerCBVCorrector.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerCBVCorrector.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the SAP_FLUX by fitting a number of cotrending basis vectors
<cite>cbvs</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cbvs</strong> : list of ints</p>
<blockquote>
<div><p>The list of cotrending basis vectors to fit to the data. For example,
[1, 2] will fit the first two basis vectors.</p>
</div></blockquote>
<p><strong>method</strong> : str</p>
<blockquote>
<div><p>Numerical optimization method. See scipy.optimize.minimize for the
full list of methods.</p>
</div></blockquote>
<p><strong>options</strong> : dict</p>
<blockquote class="last">
<div><p>Dictionary of options to be passed to scipy.optimize.minimize.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.KeplerCBVCorrector.get_cbv_url">
<code class="descname">get_cbv_url</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#KeplerCBVCorrector.get_cbv_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.KeplerCBVCorrector.get_cbv_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerCBVCorrector.lc_file">
<code class="descname">lc_file</code><a class="headerlink" href="#pyke.lightcurve.KeplerCBVCorrector.lc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyke.lightcurve.KeplerCBVCorrector.opt_result">
<code class="descname">opt_result</code><a class="headerlink" href="#pyke.lightcurve.KeplerCBVCorrector.opt_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of the optimization process.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyke.lightcurve.SPLDCorrector">
<em class="property">class </em><code class="descclassname">pyke.lightcurve.</code><code class="descname">SPLDCorrector</code><a class="reference internal" href="../_modules/pyke/lightcurve.html#SPLDCorrector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SPLDCorrector" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the simple first order Pixel Level Decorrelation (PLD) proposed by
Deming et. al. <a class="reference internal" href="#r13" id="id1">[R13]</a> and Luger et. al. <a class="reference internal" href="#r23" id="id2">[R23]</a>, <a class="reference internal" href="#r33" id="id3">[R33]</a>.</p>
<p class="rubric">Notes</p>
<p>This code serves only as a quick look into the PLD technique.
Users are encouraged to check out the GitHub repos
<a class="reference external" href="http://www.github.com/rodluger/everest">everest</a>
and <a class="reference external" href="http://www.github.com/rodluger/everest3">everest3</a>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R13]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Deming et. al. Spitzer Secondary Eclipses of the Dense, Modestly-irradiated, Giant Exoplanet HAT-P-20b using Pixel-Level Decorrelation.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r23" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R23]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> Luger et. al. EVEREST: Pixel Level Decorrelation of K2 Light Curves.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r33" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R33]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> Luger et. al. An Update to the EVEREST K2 Pipeline: short cadence, saturated stars, and Kepler-like photometry down to K_p = 15.</td></tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.SPLDCorrector.correct" title="pyke.lightcurve.SPLDCorrector.correct"><code class="xref py py-obj docutils literal"><span class="pre">correct</span></code></a>(time,&nbsp;tpf_flux[,&nbsp;window_length,&nbsp;…])</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyke.lightcurve.SPLDCorrector.correct">
<code class="descname">correct</code><span class="sig-paren">(</span><em>time</em>, <em>tpf_flux</em>, <em>window_length=None</em>, <em>polyorder=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SPLDCorrector.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SPLDCorrector.correct" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>time</strong> : array-like</p>
<blockquote>
<div><p>Time array</p>
</div></blockquote>
<p><strong>tpf_flux</strong> : array-like</p>
<blockquote>
<div><p>Pixel values series</p>
</div></blockquote>
<p><strong>window_length</strong> : int</p>
<p class="last"><strong>polyorder</strong> : int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyke.lightcurve.SFFCorrector">
<em class="property">class </em><code class="descclassname">pyke.lightcurve.</code><code class="descname">SFFCorrector</code><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the Self-Flat-Fielding (SFF) systematics removal method.</p>
<p>This method is described in detail by Vanderburg and Johnson (2014).
Briefly, the algorithm implemented in this class can be described
as follows</p>
<blockquote>
<div><ol class="arabic simple">
<li>Rotate the centroid measurements onto the subspace spanned by the
eigenvectors of the centroid covariance matrix</li>
<li>Fit a polynomial to the rotated centroids</li>
<li>Compute the arclength of such polynomial</li>
<li>Fit a BSpline of the raw flux as a function of time</li>
<li>Normalize the raw flux by the fitted BSpline computed in step (4)</li>
<li>Bin and interpolate the normalized flux as function of the arclength</li>
<li>Divide the raw flux by the piecewise linear interpolation done in step [(6)</li>
<li>Set raw flux as the flux computed in step (7) and repeat</li>
</ol>
</div></blockquote>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.SFFCorrector.arclength" title="pyke.lightcurve.SFFCorrector.arclength"><code class="xref py py-obj docutils literal"><span class="pre">arclength</span></code></a>(x1,&nbsp;x)</td>
<td>Compute the arclength of the polynomial used to fit the centroid measurements.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.SFFCorrector.bin_and_interpolate" title="pyke.lightcurve.SFFCorrector.bin_and_interpolate"><code class="xref py py-obj docutils literal"><span class="pre">bin_and_interpolate</span></code></a>(s,&nbsp;normflux,&nbsp;bins,&nbsp;sigma)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.SFFCorrector.breakpoints" title="pyke.lightcurve.SFFCorrector.breakpoints"><code class="xref py py-obj docutils literal"><span class="pre">breakpoints</span></code></a>(campaign)</td>
<td>Return a break point as a function of the campaign number.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.SFFCorrector.correct" title="pyke.lightcurve.SFFCorrector.correct"><code class="xref py py-obj docutils literal"><span class="pre">correct</span></code></a>(time,&nbsp;flux,&nbsp;centroid_col,&nbsp;centroid_row)</td>
<td>Returns a systematics-corrected LightCurve.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyke.lightcurve.SFFCorrector.fit_bspline" title="pyke.lightcurve.SFFCorrector.fit_bspline"><code class="xref py py-obj docutils literal"><span class="pre">fit_bspline</span></code></a>(time,&nbsp;flux[,&nbsp;s])</td>
<td>s describes the “smoothness” of the spline</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyke.lightcurve.SFFCorrector.rotate_centroids" title="pyke.lightcurve.SFFCorrector.rotate_centroids"><code class="xref py py-obj docutils literal"><span class="pre">rotate_centroids</span></code></a>(centroid_col,&nbsp;centroid_row)</td>
<td>Rotate the coordinate frame of the (col, row) centroids to a new (x,y) frame in which the dominant motion of the spacecraft is aligned with the x axis.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyke.lightcurve.SFFCorrector.arclength">
<code class="descname">arclength</code><span class="sig-paren">(</span><em>x1</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector.arclength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector.arclength" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the arclength of the polynomial used to fit the centroid
measurements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x1</strong> : float</p>
<blockquote>
<div><p>Upper limit of the integration domain.</p>
</div></blockquote>
<p><strong>x</strong> : ndarray</p>
<blockquote>
<div><p>Domain at which the arclength integrand is defined.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>arclength</strong> : float</p>
<blockquote class="last">
<div><p>Result of the arclength integral from x[0] to x1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.SFFCorrector.bin_and_interpolate">
<code class="descname">bin_and_interpolate</code><span class="sig-paren">(</span><em>s</em>, <em>normflux</em>, <em>bins</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector.bin_and_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector.bin_and_interpolate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.SFFCorrector.breakpoints">
<code class="descname">breakpoints</code><span class="sig-paren">(</span><em>campaign</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector.breakpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector.breakpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a break point as a function of the campaign number.</p>
<p>The intention of this function is to implement a smart way to determine
the boundaries of the windows on which the SFF algorithm is applied
independently. However, this is not implemented yet in this version.</p>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.SFFCorrector.correct">
<code class="descname">correct</code><span class="sig-paren">(</span><em>time</em>, <em>flux</em>, <em>centroid_col</em>, <em>centroid_row</em>, <em>polyorder=5</em>, <em>niters=3</em>, <em>bins=15</em>, <em>windows=1</em>, <em>sigma_1=3.0</em>, <em>sigma_2=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a systematics-corrected LightCurve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>time</strong> : array-like</p>
<blockquote>
<div><p>Time measurements</p>
</div></blockquote>
<p><strong>flux</strong> : array-like</p>
<blockquote>
<div><p>Data flux for every time point</p>
</div></blockquote>
<p><strong>centroid_col, centroid_row</strong> : array-like, array-like</p>
<blockquote>
<div><p>Centroid column and row coordinates as a function of time</p>
</div></blockquote>
<p><strong>polyorder</strong> : int</p>
<blockquote>
<div><p>Degree of the polynomial which will be used to fit one
centroid as a function of the other.</p>
</div></blockquote>
<p><strong>niters</strong> : int</p>
<blockquote>
<div><p>Number of iterations of the aforementioned algorithm.</p>
</div></blockquote>
<p><strong>bins</strong> : int</p>
<blockquote>
<div><p>Number of bins to be used in step (6) to create the
piece-wise interpolation of arclength vs flux correction.</p>
</div></blockquote>
<p><strong>windows</strong> : int</p>
<blockquote>
<div><p>Number of windows to subdivide the data.  The SFF algorithm
is ran independently in each window.</p>
</div></blockquote>
<p><strong>sigma_1, sigma_2</strong> : float, float</p>
<blockquote>
<div><p>Sigma values which will be used to reject outliers
in steps (6) and (2), respectivelly.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>corrected_lightcurve</strong> : LightCurve object</p>
<blockquote class="last">
<div><p>Returns a corrected lightcurve object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.SFFCorrector.fit_bspline">
<code class="descname">fit_bspline</code><span class="sig-paren">(</span><em>time</em>, <em>flux</em>, <em>s=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector.fit_bspline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector.fit_bspline" title="Permalink to this definition">¶</a></dt>
<dd><p>s describes the “smoothness” of the spline</p>
</dd></dl>

<dl class="method">
<dt id="pyke.lightcurve.SFFCorrector.rotate_centroids">
<code class="descname">rotate_centroids</code><span class="sig-paren">(</span><em>centroid_col</em>, <em>centroid_row</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/lightcurve.html#SFFCorrector.rotate_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.lightcurve.SFFCorrector.rotate_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the coordinate frame of the (col, row) centroids to a new (x,y)
frame in which the dominant motion of the spacecraft is aligned with
the x axis.  This makes it easier to fit a characteristic polynomial
that describes the motion.</p>
</dd></dl>

</dd></dl>

<div class="section" id="inheritance-diagram">
<h2>Inheritance Diagram<a class="headerlink" href="#inheritance-diagram" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright PyKE Developers and Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>